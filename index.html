<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PM Lab Wizard</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color: #f3f4f6; display: flex; align-items: center; justify-content: center; min-height: 100vh; margin: 0; }
        .wizard-container { background: white; width: 100%; max-width: 600px; padding: 40px; border-radius: 16px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .step { display: none; }
        .step.active { display: block; animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .progress-bar { display: flex; justify-content: space-between; margin-bottom: 30px; position: relative; }
        .progress-bar::before { content: ""; background: #e5e7eb; height: 2px; width: 100%; position: absolute; top: 15px; left: 0; z-index: 0; }
        .progress-step { width: 30px; height: 30px; background: #e5e7eb; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 14px; z-index: 1; position: relative; transition: 0.3s; }
        .progress-step.active { background: #2563eb; color: white; }
        
        h2 { color: #111827; margin-top: 0; font-size: 1.5rem; }
        p { color: #4b5563; line-height: 1.6; }
        
        .code-container { position: relative; background: #1e293b; border-radius: 8px; margin: 15px 0; border: 1px solid #334155; }
        code { color: #f8fafc; padding: 20px; display: block; font-family: 'Courier New', monospace; font-size: 13px; line-height: 1.5; overflow-x: auto; white-space: pre; }
        .copy-btn { position: absolute; top: 10px; right: 10px; background: #475569; color: white; border: none; padding: 5px 10px; border-radius: 4px; font-size: 12px; cursor: pointer; transition: 0.2s; }
        .copy-btn:hover { background: #64748b; }
        .copy-btn.copied { background: #059669; }

        .nav-buttons { display: flex; justify-content: space-between; margin-top: 30px; }
        .btn { padding: 12px 24px; border-radius: 8px; font-weight: 600; cursor: pointer; border: none; transition: 0.2s; text-decoration: none; display: inline-block; font-size: 15px; }
        .btn-next { background: #2563eb; color: white; }
        .btn-prev { background: #f3f4f6; color: #4b5563; }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .btn-external { background: #059669; color: white; width: 100%; text-align: center; box-sizing: border-box; margin-bottom: 10px; }
        
        small { color: #6b7280; display: block; margin-top: 10px; }
    </style>
</head>
<body>

<div class="wizard-container">
    <div class="progress-bar">
        <div class="progress-step active" id="p1">1</div>
        <div class="progress-step" id="p2">2</div>
        <div class="progress-step" id="p3">3</div>
        <div class="progress-step" id="p4">4</div>
    </div>

    <div class="step active" id="step1">
        <h2>üöÄ Step 1: Deploy Infrastructure</h2>
        <p>This will build your Web Store and Database. A new browser tab will open for the setup.</p>
        <p><strong>Required Actions:</strong><br>
           1. Sign in with Google/GitHub.<br>
           2. When asked for Storage, click <b>"Connect Neon Postgres"</b>.</p>
        <a href="https://vercel.com/new/clone?repository-url=https%3A%2F%2Fgithub.com%2Fmedusajs%2Fmedusa-starter-default&env=MEDUSA_ADMIN_ONBOARDING_TYPE&project-name=my-product-lab&repository-name=my-product-lab" 
           target="_blank" class="btn btn-external">Open Deployment Tab ‚Üí</a>
        <small>After you see "Congratulations" in the Vercel tab, return here and click Next.</small>
    </div>

    <div class="step" id="step2">
        <h2>üîë Step 2: Copy Connection URL</h2>
        <p>Go back to the <b>Vercel tab</b> to find your database credentials:</p>
        <ol>
            <li>Navigate to the <b>Storage</b> tab in Vercel.</li>
            <li>Select your <b>Neon</b> database icon.</li>
            <li>Copy the <b>Postgres Connection String</b> (starts with <code>postgres://</code>).</li>
        </ol>
        <p><small>Keep this URL ready for the next step.</small></p>
    </div>

    <div class="step" id="step3">
        <h2>ü§ñ Step 3: Setup Claude AI</h2>
        <p>Open <b>Claude Desktop</b> > Settings > MCP > Edit Config. Copy the block below and paste it inside <code>"mcpServers"</code>:</p>
        
        <div class="code-container">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <code id="mcpCode">"postgresql": {
  "command": "npx",
  "args": [
    "-y",
    "@modelcontextprotocol/server-postgres",
    "PASTE_URL_HERE?sslmode=require"
  ]
}</code>
        </div>
        <p style="color: #b91c1c; font-size: 14px; font-weight: bold;">
            ‚ö†Ô∏è Don't forget to replace 'PASTE_URL_HERE' with your URL, keeping the suffix!
        </p>
    </div>

    <div class="step" id="step4">
        <h2>‚úÖ Step 4: Final Verification</h2>
        <p>Your AI Analyst is now connected to your store! Open Claude and ask:</p>
        <div style="background: #f8fafc; border: 1px dashed #cbd5e1; padding: 15px; border-radius: 8px; font-style: italic;">
            "Access my database and list the top 3 product categories by the number of products they contain."
        </div>
        <p><small>If it works, your lab is fully operational. Restart Claude if you see any connection errors.</small></p>
    </div>

    <div class="nav-buttons">
        <button class="btn btn-prev" id="prevBtn" onclick="changeStep(-1)" disabled>Back</button>
        <button class="btn btn-next" id="nextBtn" onclick="changeStep(1)">Next</button>
    </div>
</div>

<script>
    let currentStep = 1;

    function changeStep(n) {
        document.getElementById(`step${currentStep}`).classList.remove('active');
        document.getElementById(`p${currentStep}`).classList.remove('active');
        
        currentStep += n;
        
        document.getElementById(`step${currentStep}`).classList.add('active');
        document.getElementById(`p${currentStep}`).classList.add('active');
        
        document.getElementById('prevBtn').disabled = (currentStep === 1);
        document.getElementById('nextBtn').innerText = (currentStep === 4) ? 'Finish' : 'Next';
        
        if (currentStep > 4) {
            alert("Lab Setup Complete!");
            location.reload();
        }
    }

    function copyCode(btn) {
        const code = document.getElementById('mcpCode').innerText;
        navigator.clipboard.writeText(code).then(() => {
            btn.innerText = "Copied!";
            btn.classList.add('copied');
            setTimeout(() => {
                btn.innerText = "Copy";
                btn.classList.remove('copied');
            }, 2000);
        });
    }
</script>

</body>
</html>
